language: cpp
dist: trusty
sudo: require
compiler:
  - clang
git:
  depth: 5

before_install:
  - sudo add-apt-repository ppa:beineri/opt-qt593-trusty -y
  - sudo apt-get update -qq

install:
  - sudo apt-get -y install qt59base qt59webengine qt59x11extras
  - source /opt/qt*/bin/qt*-env.sh
  - export PATH=/opt/qt59/bin:$PATH
  - SRC="cmake-build-relwithdebinfo"
  - CMAKE_NAME="TimeCampDesktop"

before_script:
  - cp CMakeProjectConfig.cmake.example CMakeProjectConfig.cmake

script:
  - cd $SRC
  - cmake -DCMAKE_BUILD_TYPE=RelWithDebInfo -G "Unix Makefiles" "../"
  - cd ../
  - cmake --build $SRC --target "${CMAKE_NAME}" --

branches:
  except:
    - # Do not build tags that we create when we upload to GitHub Releases
    - /^(?i:continuous)/
